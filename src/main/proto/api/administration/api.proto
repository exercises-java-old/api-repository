syntax = "proto3";

import "google/protobuf/timestamp.proto";
import "google/protobuf/empty.proto";
import "google/protobuf/wrappers.proto";

package administration;

option java_multiple_files = true;
option java_package = "com.so4it.administration";
option java_outer_classname = "AdministrationProtos";

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  DEPRECATED, moved to package "configuration"
//  Application API
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
service ApplicationApiService {
    rpc CreateApplication (CreateApplicationRequest) returns (CreateApplicationResponse) {
    }

    rpc DeleteApplication (DeleteApplicationRequest) returns (DeleteApplicationResponse) {
    }

    rpc GetApplications (GetApplicationsRequest) returns (GetApplicationsResponse) {
    }

    rpc GetApplication (GetApplicationRequest) returns (GetApplicationResponse) {
    }

    rpc CreatePropertyDescriptors (CreateApplicationPropertyDescriptorsRequest) returns (CreateApplicationPropertyDescriptorsResponse){
    }

    rpc DeletePropertyDescriptors (DeleteApplicationPropertyDescriptorsRequest) returns (DeleteApplicationPropertyDescriptorsResponse){
    }

    rpc GetPropertyDescriptor (GetApplicationPropertyDescriptorRequest) returns (GetApplicationPropertyDescriptorResponse){
    }
}

message CreateApplicationRequest {
    string name = 1;
}

message CreateApplicationResponse {
    Application application = 1;
}

message DeleteApplicationRequest {
    string name = 1;
}

message DeleteApplicationResponse {
}

message GetApplicationRequest {
    string name = 1;
}

message GetApplicationResponse {
    Application application = 1;
}

message GetApplicationsRequest {
}

message GetApplicationsResponse {
    ApplicationNames applications = 1;
}

message CreateApplicationPropertyDescriptorsRequest{
    google.protobuf.StringValue applicationName = 1;
    PropertyDescriptors propertyDescriptors = 2;
}

message CreateApplicationPropertyDescriptorsResponse{
}

message DeleteApplicationPropertyDescriptorsRequest{
    google.protobuf.StringValue applicationName = 1;
    PropertyDescriptorNames propertyDescriptors = 2;
}

message DeleteApplicationPropertyDescriptorsResponse{
}

message GetApplicationPropertyDescriptorRequest{
    google.protobuf.StringValue applicationName = 1;
    google.protobuf.StringValue propertyName = 2;
}

message GetApplicationPropertyDescriptorResponse {
    PropertyDescriptor propertyDescriptor = 1;
}

message Application {
    string name = 1;
    repeated PropertyDescriptorName propertyDescriptors = 2;
    google.protobuf.Timestamp lastModified = 3;
    google.protobuf.BoolValue legacyFormat = 4;
}

message ApplicationName {
    google.protobuf.StringValue name = 1;
}

message ApplicationNames {
    repeated ApplicationName names = 1 [packed = false];
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  DEPRECATED, moved to package "configuration"
//  Framework API
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
service FrameworkApiService {
    rpc CreateFramework (CreateFrameworkRequest) returns (CreateFrameworkResponse) {
    }

    rpc DeleteFramework (DeleteFrameworkRequest) returns (DeleteFrameworkResponse) {
    }

    rpc GetFrameworks (GetFrameworksRequest) returns (GetFrameworksResponse) {
    }

    rpc GetFramework (GetFrameworkRequest) returns (GetFrameworkResponse) {
    }

    rpc CreatePropertyDescriptors (CreateFrameworkPropertyDescriptorsRequest) returns (CreateFrameworkPropertyDescriptorsResponse){
    }

    rpc DeletePropertyDescriptors (DeleteFrameworkPropertyDescriptorsRequest) returns (DeleteFrameworkPropertyDescriptorsResponse){
    }

    rpc GetPropertyDescriptor (GetFrameworkPropertyDescriptorRequest) returns (GetFrameworkPropertyDescriptorResponse){
    }
}

message CreateFrameworkRequest {
    string name = 1;
}

message CreateFrameworkResponse {
    Framework framework = 1;
}

message DeleteFrameworkRequest {
    string name = 1;
}

message DeleteFrameworkResponse {
}

message GetFrameworkRequest {
    string name = 1;
}

message GetFrameworkResponse {
    Framework framework = 1;
}

message GetFrameworksRequest {
}

message GetFrameworksResponse {
    FrameworkNames frameworks = 1;
}

message CreateFrameworkPropertyDescriptorsRequest{
    google.protobuf.StringValue frameworkName = 1;
    PropertyDescriptors propertyDescriptors = 2;
}

message CreateFrameworkPropertyDescriptorsResponse{
}

message DeleteFrameworkPropertyDescriptorsRequest{
    google.protobuf.StringValue frameworkName = 1;
    PropertyDescriptorNames propertyDescriptors = 2;
}

message DeleteFrameworkPropertyDescriptorsResponse{
}

message GetFrameworkPropertyDescriptorRequest{
    google.protobuf.StringValue frameworkName = 1;
    google.protobuf.StringValue propertyName = 2;
}

message GetFrameworkPropertyDescriptorResponse {
    PropertyDescriptor propertyDescriptor = 1;
}

message Framework {
    string name = 1;
    repeated PropertyDescriptorName propertyDescriptors = 2;
    google.protobuf.Timestamp lastModified = 3;
}

message FrameworkName {
    google.protobuf.StringValue name = 1;
}

message FrameworkNames {
    repeated FrameworkName names = 1 [packed = false];
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  DEPRECATED, moved to package "configuration"
//  Environment API
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
service EnvironmentApiService {
    rpc GetEnvironment (GetEnvironmentRequest) returns (EnvironmentResponse) {
    }

    rpc GetEnvironments (GetEnvironmentsRequest) returns (EnvironmentNames) {
    }

    rpc CreateEnvironment (CreateEnvironmentRequest) returns (Environment) {
    }

    rpc DeleteEnvironment (DeleteEnvironmentRequest) returns (google.protobuf.Empty)  {
    }

    rpc AttachSources (AttachSourcesRequest) returns (EnvironmentResponse){
    }

    rpc ReplaceSources (ReplaceSourcesRequest) returns (EnvironmentResponse){
    }

    rpc DetachSources (DetachSourcesRequest) returns (EnvironmentResponse){
    }

    rpc GetEnvironmentProperties (GetEnvironmentPropertiesRequest) returns (GetEnvironmentPropertiesResponse);
}

message EnvironmentNames {
    repeated string name = 1 [packed = false];
}

message Environment {
    string name = 1;
    repeated string tags = 2 [packed = false];
    repeated string sources = 3 [packed = false];
    string lockedVersionTag = 4;
    google.protobuf.BoolValue restricted = 5;
}

message GetEnvironmentRequest {
    string name = 1;
}

message EnvironmentResponse {
    Environment environment = 1;
}

message GetEnvironmentsRequest {
}

message CreateEnvironmentRequest {
    Environment environment = 1;
}

message AttachSourcesRequest {
    string name = 1;
    int32 index = 2;
    repeated string sources = 3;
}

message ReplaceSourcesRequest {
    string name = 1;
    repeated string sources = 3;
}

message DetachSourcesRequest {
    string name = 1;
    repeated string sources = 3;
}

message DeleteEnvironmentRequest {
    string name = 1;
}

message GetEnvironmentPropertiesRequest {
    string name = 1;
    string application = 2;
    google.protobuf.BoolValue resolvedDuplicates = 3;
}

message GetEnvironmentPropertiesResponse {
    PropertyValues propertyValues = 1;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  DEPRECATED, moved to package "configuration"
//  ConfigurationSource API
//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
service ConfigurationSourceApiService {
    rpc CreateConfigurationSource (CreateConfigurationSourceRequest) returns (google.protobuf.Empty) {
    }

    rpc DeleteConfigurationSource (DeleteConfigurationSourceRequest) returns (google.protobuf.Empty) {
    }

    rpc AssignPropertyValues (AssignPropertyValuesRequest) returns (google.protobuf.Empty) {
    }

    rpc RemovePropertyValues (RemovePropertyValuesRequest) returns (google.protobuf.Empty) {
    }

    rpc GetConfigurationSource (GetConfigurationSourceRequest) returns (GetConfigurationSourceResponse) {
    }

    rpc GetConfigurationSources (google.protobuf.Empty) returns (ConfigurationSources) {
    }
}

message CreateConfigurationSourceRequest{
    string name = 1;
    PropertyValues propertyValues = 2;
    Resources resources = 3;
}

message DeleteConfigurationSourceRequest{
    string name = 1;
}

message AssignPropertyValuesRequest {
    string sourceName = 1;
    PropertyValues propertyValues = 2;
}

message RemovePropertyValuesRequest {
    string sourceName = 1;
    PropertyNames propertyNames = 2;
}

message GetConfigurationSourceRequest {
    string sourceName = 1;
    google.protobuf.BoolValue includePropertyValues = 2;
    google.protobuf.BoolValue includeResourceNames = 3;
}

message GetConfigurationSourceResponse {
    ConfigurationSource configurationSource = 1;
    PropertyValues propertyValues = 2;
    ResourceNames resourceNames = 3;
}

message ConfigurationSources {
    repeated ConfigurationSource configurationSources = 1;
}

message ConfigurationSource {
    string name = 1;
}

message PropertyName {
    string name = 1;
    string application = 2;
}

message PropertyNames {
    repeated PropertyName propertyNames = 1 [packed = false];
}

message PropertyValue {
    string name = 1;
    string value = 2;
    string application = 3;
}

message PropertyValues {
    repeated PropertyValue entry = 1 [packed = false];
}

message Resource {
    string path = 1;
    string data = 2;
}

message Resources {
    repeated Resource resource = 1 [packed = false];
}

message ResourceName {
    string path = 1;
}

message ResourceNames {
    repeated ResourceName name = 1 [packed = false];
}

enum PropertyType {
    BOOLEAN = 0;
    INTEGER = 1;
    LONG = 2;
    STRING = 3;
}


message TemplateField {
    string name = 1;
    string description = 2;
}

message PropertyDescriptor {

    google.protobuf.StringValue propertyName = 1;

    PropertyType propertyType = 2;

    google.protobuf.StringValue defaultValue = 3;

    google.protobuf.StringValue description = 4;

    google.protobuf.BoolValue encrypted = 5;

    google.protobuf.BoolValue template = 6;

    google.protobuf.StringValue namingPattern = 7;

    repeated TemplateField templateField = 8;
}

message PropertyDescriptors {
    repeated PropertyDescriptor propertyDescriptor = 1;
}

message PropertyDescriptorName {
    google.protobuf.StringValue name = 1;
}

message PropertyDescriptorNames {
    repeated PropertyDescriptorName propertyDescriptor = 1 [packed = false];
}
